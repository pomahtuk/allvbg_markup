!function(){$(function(){var e,t,n,i,r,o,a,s;return $(".aside-1 a.hover").click(function(){var e,t;return t=$("#extra_panel"),e=$(this),t.is(":visible")&&t.hasClass(e.data("panel"))?(t.hide().attr("class",""),e.removeClass("active")):(t.show().attr("class","").addClass(e.data("panel")),$(".aside-1 a.hover").removeClass("active"),e.addClass("active"),"add_firm"===e.data("panel")&&Firm.initialize()),!1}),e={},t="custom_style",a=[{featureType:"landscape",stylers:[{saturation:-100}]},{featureType:"water",stylers:[{saturation:-100}]},{featureType:"road",stylers:[{saturation:-100}]},{featureType:"poi",stylers:[{saturation:-100}]}],o={zoom:14,center:new google.maps.LatLng(60.705288,28.762311),disableDefaultUI:!0,mapTypeId:t},e.map=new google.maps.Map(document.getElementById("YMapsID"),o),r=new google.maps.StyledMapType(a,{name:"Grayscale"}),e.map.mapTypes.set(t,r),e.markers={},s=function(){var t;return t=new InfoBubble({maxWidth:240,content:'<div class="ymaps_ballon_opened">\n  <div class="content">\n    <img src="'+this.sub_element.description+'" />\n    <a href="'+this.sub_element.link+'">\n      <h3>'+this.sub_element.name+'</h3>\n    </a>\n    <div class="tags">\n      '+this.sub_element.tags+'\n    </div>\n  </div>\n  <div class="footer">\n    Рейтинг: '+this.sub_element.rating+"\n  </div>\n</div>",shadowStyle:1,padding:0,borderRadius:4,arrowSize:10,borderWidth:0,hideCloseButton:!0,backgroundColor:"rgb(243, 243, 243)"}),e.visibleInfoBubble&&e.visibleInfoBubble.close(),t.open(e.map,this.marker),e.visibleInfoBubble=t},n=function(t,n){return e.markers["menu"+t.description]={},$('<li><ul id="menu'+t.description+'"></ul></li>').appendTo(n)},i=function(t,n){var i,r,o,a,l,c,u,d,p,h;for(n=$(n),r="",r=null!=t.elements[0].marker?t.elements[0].marker:"http://allvbg.ru/static/allvbg/img/transparent.png",o=$("<a class='title_sub' data-name='"+t.name+"' href='#'><img src='"+r+"' alt=' '/>"+t.name+"</a>"),o.click(function(){var t,i,r,o,a,s,l;for(t=$(this),e.visibleInfoBubble&&e.visibleInfoBubble.close(),t.hasClass("active_sub")?(i=null,t.removeClass("active_sub")):(i=e.map,t.addClass("active_sub")),s=e.markers[""+n.attr("id")][""+t.data("name")],l=[],o=0,a=s.length;a>o;o++)r=s[o],l.push(r.setMap(i));return l}).appendTo($("<li></li>").appendTo(n)),e.markers[""+n.attr("id")][""+t.name]=[],p=t.elements,h=[],u=0,d=p.length;d>u;u++)c=p[u],null!=c.coordinates?(i=c.coordinates.split(","),a=new google.maps.Marker({position:new google.maps.LatLng(i[1],i[0]),icon:r,map:null}),e.markers[""+n.attr("id")][""+t.name].push(a),l={sub_element:c,marker:a},h.push(google.maps.event.addListener(a,"click",s.bind(l)))):h.push(void 0);return h},$.ajax({type:"GET",url:"http://allvbg.ru/map.json",dataType:"jsonp"}).done(function(e){var t,r,o,a,s,l,c,u,d;for(u=e.elements,a=0,l=u.length;l>a;a++)if(r=u[a],null!=r.elements)for(n(r,$("#menu")),d=r.elements,s=0,c=d.length;c>s;s++)o=d[s],null!=o.elements&&(t="#menu"+r.description,i(o,t));return $("#scrollbar1").tinyscrollbar()}).error(function(){return alert("При загрузке карты произошла ошибка")})})}.call(this);