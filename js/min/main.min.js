!function(){$(function(){var e,a,n,t,s,l,r,i;return $(".aside-1 a.hover").click(function(){var e,a;return a=$("#extra_panel"),e=$(this),a.is(":visible")&&a.hasClass(e.data("panel"))?(a.hide().attr("class",""),e.removeClass("active")):(a.show().attr("class","").addClass(e.data("panel")),$(".aside-1 a.hover").removeClass("active"),e.addClass("active"),"add_firm"===e.data("panel")&&Firm.initialize()),!1}),e={},a="custom_style",r=[{featureType:"landscape",stylers:[{saturation:-100}]},{featureType:"water",stylers:[{saturation:-100}]},{featureType:"road",stylers:[{saturation:-100}]},{featureType:"poi",stylers:[{saturation:-100}]}],l={zoom:14,center:new google.maps.LatLng(60.705288,28.762311),disableDefaultUI:!0,mapTypeId:a},e.map=new google.maps.Map(document.getElementById("YMapsID"),l),s=new google.maps.StyledMapType(r,{name:"Grayscale"}),e.map.mapTypes.set(a,s),e.markers={},i=function(){var a;return a=new InfoBubble({maxWidth:240,content:'<div class="ymaps_ballon_opened">\n  <div class="content">\n    <img src="'+this.sub_element.description+'" />\n    <a href="'+this.sub_element.link+'">\n      <h3>'+this.sub_element.name+'</h3>\n    </a>\n    <div class="tags">\n      '+this.sub_element.tags+'\n    </div>\n  </div>\n  <div class="footer">\n    Рейтинг: '+this.sub_element.rating+"\n  </div>\n</div>",shadowStyle:1,padding:0,borderRadius:4,arrowSize:10,borderWidth:0,hideCloseButton:!0,backgroundColor:"rgb(243, 243, 243)"}),e.visibleInfoBubble&&e.visibleInfoBubble.close(),a.open(e.map,this.marker),e.visibleInfoBubble=a},n=function(a,n){return e.markers["menu"+a.description]={},$('<li><ul id="menu'+a.description+'"></ul></li>').appendTo(n)},t=function(a,n){var t,s,l,r,o,u,d,m,p,c;for(n=$(n),s="",s=null!=a.elements[0].marker?a.elements[0].marker:"http://allvbg.ru/static/allvbg/img/transparent.png",l=$("<a class='title_sub' data-name='"+a.name+"' href='#'><img src='"+s+"' alt=' '/>"+a.name+"</a>"),l.click(function(){var a,t,s,l,r,i,o;for(a=$(this),e.visibleInfoBubble&&e.visibleInfoBubble.close(),a.hasClass("active_sub")?(t=null,a.removeClass("active_sub")):(t=e.map,a.addClass("active_sub")),i=e.markers[""+n.attr("id")][""+a.data("name")],o=[],l=0,r=i.length;r>l;l++)s=i[l],o.push(s.setMap(t));return o}).appendTo($("<li></li>").appendTo(n)),e.markers[""+n.attr("id")][""+a.name]=[],p=a.elements,c=[],d=0,m=p.length;m>d;d++)u=p[d],null!=u.coordinates?(t=u.coordinates.split(","),r=new google.maps.Marker({position:new google.maps.LatLng(t[1],t[0]),icon:s,map:null}),e.markers[""+n.attr("id")][""+a.name].push(r),o={sub_element:u,marker:r},google.maps.event.addListener(r,"click",i.bind(o)),c.push(google.maps.event.addListener(e.map,"click",function(){return e.visibleInfoBubble?e.visibleInfoBubble.close():void 0}))):c.push(void 0);return c},$.ajax({type:"GET",url:"http://allvbg.ru/map.json",dataType:"jsonp"}).done(function(e){var a,s,l,r,i,o,u,d,m;for(d=e.elements,r=0,o=d.length;o>r;r++)if(s=d[r],null!=s.elements)for(n(s,$("#menu")),m=s.elements,i=0,u=m.length;u>i;i++)l=m[i],null!=l.elements&&(a="#menu"+s.description,t(l,a));return $("#scrollbar1").tinyscrollbar()}).error(function(){return alert("При загрузке карты произошла ошибка")})})}.call(this);