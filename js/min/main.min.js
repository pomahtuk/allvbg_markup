!function(){$(function(){var e,t,n,i,o,r,s,a;return $(".aside-1 a.hover").click(function(){var e,t;return t=$("#extra_panel"),e=$(this),t.is(":visible")&&t.hasClass(e.data("panel"))?(t.hide().attr("class",""),e.removeClass("active")):(t.show().attr("class","").addClass(e.data("panel")),$(".aside-1 a.hover").removeClass("active"),e.addClass("active")),!1}),e={},t="custom_style",s=[{featureType:"landscape",stylers:[{saturation:-100}]},{featureType:"water",stylers:[{saturation:-100}]},{featureType:"road",stylers:[{saturation:-100}]},{featureType:"poi",stylers:[{saturation:-100}]}],r={zoom:14,center:new google.maps.LatLng(60.705288,28.762311),disableDefaultUI:!0,mapTypeId:t},e.map=new google.maps.Map(document.getElementById("YMapsID"),r),o=new google.maps.StyledMapType(s,{name:"Grayscale"}),e.map.mapTypes.set(t,o),e.markers={},a=function(){var t;return t=new InfoBubble({maxWidth:240,content:'<div class="ymaps_ballon_opened">\n  <div class="content">\n    <img src="'+this.sub_element.description+'" />\n    <a href="'+this.sub_element.link+'">\n      <h3>'+this.sub_element.name+'</h3>\n    </a>\n    <div class="tags">\n      '+this.sub_element.tags+'\n    </div>\n  </div>\n  <div class="footer">\n    Рейтинг: '+this.sub_element.rating+"\n  </div>\n</div>",shadowStyle:1,padding:0,borderRadius:4,arrowSize:10,borderWidth:0,hideCloseButton:!0,backgroundColor:"rgb(243, 243, 243)"}),e.visibleInfoBubble&&e.visibleInfoBubble.close(),t.open(e.map,this.marker),e.visibleInfoBubble=t},n=function(t,n){return e.markers["menu"+t.description]={},$('<li><ul id="menu'+t.description+'"></ul></li>').appendTo(n)},i=function(t,n){var i,o,r,s,l,c,u,d,h,p;for(n=$(n),o="",o=null!=t.elements[0].marker?t.elements[0].marker:"http://allvbg.ru/static/allvbg/img/transparent.png",r=$("<a class='title_sub' data-name='"+t.name+"' href='#'><img src='"+o+"' alt=' '/>"+t.name+"</a>"),r.click(function(){var t,i,o,r,s,a,l;for(t=$(this),e.visibleInfoBubble&&e.visibleInfoBubble.close(),t.hasClass("active_sub")?(i=null,t.removeClass("active_sub")):(i=e.map,t.addClass("active_sub")),a=e.markers[""+n.attr("id")][""+t.data("name")],l=[],r=0,s=a.length;s>r;r++)o=a[r],l.push(o.setMap(i));return l}).appendTo($("<li></li>").appendTo(n)),e.markers[""+n.attr("id")][""+t.name]=[],h=t.elements,p=[],u=0,d=h.length;d>u;u++)c=h[u],null!=c.coordinates?(i=c.coordinates.split(","),s=new google.maps.Marker({position:new google.maps.LatLng(i[1],i[0]),icon:o,map:null}),e.markers[""+n.attr("id")][""+t.name].push(s),l={sub_element:c,marker:s},p.push(google.maps.event.addListener(s,"click",a.bind(l)))):p.push(void 0);return p},$.ajax({type:"GET",url:"http://allvbg.ru/map.json",dataType:"jsonp"}).done(function(e){var t,o,r,s,a,l,c,u,d;for(u=e.elements,s=0,l=u.length;l>s;s++)if(o=u[s],null!=o.elements)for(n(o,$("#menu")),d=o.elements,a=0,c=d.length;c>a;a++)r=d[a],null!=r.elements&&(t="#menu"+o.description,i(r,t));return $("#scrollbar1").tinyscrollbar()}).error(function(){return alert("При загрузке карты произошла ошибка")})})}.call(this);