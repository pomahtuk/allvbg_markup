!function(){$(document).ready(function(){var e,t,i,o,n,s,r,a;return e={},t="custom_style",r=[{featureType:"landscape",stylers:[{saturation:-100}]},{featureType:"water",stylers:[{saturation:-100}]},{featureType:"road",stylers:[{saturation:-100}]},{featureType:"poi",stylers:[{saturation:-100}]}],s={zoom:14,center:new google.maps.LatLng(60.705288,28.762311),disableDefaultUI:!0,mapTypeId:t},e.map=new google.maps.Map(document.getElementById("YMapsID"),s),n=new google.maps.StyledMapType(r,{name:"Grayscale"}),e.map.mapTypes.set(t,n),e.markers={},a=function(){var t;return t=new InfoBubble({maxWidth:240,content:'<div class="ymaps_ballon_opened">\n  <div class="content">\n    <img src="'+this.sub_element.description+'" />\n    <a href="'+this.sub_element.link+'">\n      <h3>'+this.sub_element.name+'</h3>\n    </a>\n    <div class="tags">\n      '+this.sub_element.tags+'\n    </div>\n  </div>\n  <div class="footer">\n    Рейтинг: '+this.sub_element.rating+"\n  </div>\n</div>",shadowStyle:1,padding:0,borderRadius:4,arrowSize:10,borderWidth:0,hideCloseButton:!0,backgroundColor:"rgb(243, 243, 243)"}),e.visibleInfoBubble&&e.visibleInfoBubble.close(),t.open(e.map,this.marker),e.visibleInfoBubble=t},i=function(t,i){return console.log,e.markers["menu"+t.description]={},$('<li><ul id="menu'+t.description+'"></ul></li>').appendTo(i)},o=function(t,i){var o,n,s,r,l,d,h,c,u,p;for(i=$(i),n="",n=null!=t.elements[0].marker?t.elements[0].marker:"http://allvbg.ru/static/allvbg/img/transparent.png",s=$("<a class='title_sub' data-name='"+t.name+"' href='#'><img src='"+n+"' alt=' '/>"+t.name+"</a>"),s.click(function(){var t,o,n,s,r,a,l;for(t=$(this),e.visibleInfoBubble&&e.visibleInfoBubble.close(),t.hasClass("active_sub")?(o=null,t.removeClass("active_sub")):(o=e.map,t.addClass("active_sub")),a=e.markers[""+i.attr("id")][""+t.data("name")],l=[],s=0,r=a.length;r>s;s++)n=a[s],l.push(n.setMap(o));return l}).appendTo($("<li></li>").appendTo(i)),e.markers[""+i.attr("id")][""+t.name]=[],u=t.elements,p=[],h=0,c=u.length;c>h;h++)d=u[h],null!=d.coordinates?(o=d.coordinates.split(","),r=new google.maps.Marker({position:new google.maps.LatLng(o[1],o[0]),icon:n,map:null}),e.markers[""+i.attr("id")][""+t.name].push(r),l={sub_element:d,marker:r},p.push(google.maps.event.addListener(r,"click",a.bind(l)))):p.push(void 0);return p},$.ajax({type:"GET",url:"http://allvbg.ru/map.json",dataType:"jsonp"}).done(function(e){var t,n,s,r,a,l,d,h,c;for(console.log(e),h=e.elements,r=0,l=h.length;l>r;r++)if(n=h[r],null!=n.elements)for(i(n,$("#menu")),c=n.elements,a=0,d=c.length;d>a;a++)s=c[a],null!=s.elements&&(t="#menu"+n.description,o(s,t));return $("#scrollbar1").tinyscrollbar()}).error(function(){return alert("При загрузке карты произошла ошибка")})})}.call(this);